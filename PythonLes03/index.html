<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Times+New+Roman:300,300italic,400,400italic,700,700italic%7CGeorgia:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hwchai.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="通过前面两周课程的学习，我们了解了现代科研体系中编程语言的必要作用，而Python等解释型语言由于其便捷易开发的优势又是其中的主力军之一。以及对Python语言的基础知识包括注释、对象类型（数字、字符串、布尔型等）、运算符（位运算符、赋值运算符、逻辑运算符）等。第三周课程我们将学习Python语言编写时的缩进规则、函数的用法、流程控制语句以及NumPy模块的初步使用。">
<meta property="og:type" content="article">
<meta property="og:title" content="Python在科研中的应用 02：函数、流程控制语句与NumPy初步">
<meta property="og:url" content="https://hwchai.com/PythonLes03/index.html">
<meta property="og:site_name" content="Hai-Wei Chai&#39;s Blog">
<meta property="og:description" content="通过前面两周课程的学习，我们了解了现代科研体系中编程语言的必要作用，而Python等解释型语言由于其便捷易开发的优势又是其中的主力军之一。以及对Python语言的基础知识包括注释、对象类型（数字、字符串、布尔型等）、运算符（位运算符、赋值运算符、逻辑运算符）等。第三周课程我们将学习Python语言编写时的缩进规则、函数的用法、流程控制语句以及NumPy模块的初步使用。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s21.ax1x.com/2024/10/17/pAUMSfI.png">
<meta property="og:image" content="https://docs.sunfounder.com/projects/thales-kit/en/latest/_images/while_loop.png">
<meta property="og:image" content="https://docs.sunfounder.com/projects/thales-kit/en/latest/_images/if_elif_else.png">
<meta property="og:image" content="https://docs.sunfounder.com/projects/thales-kit/en/latest/_images/for_loop.png">
<meta property="og:image" content="https://www.yooo.ltd/images/2020/07/04/list.webp">
<meta property="og:image" content="https://www.yooo.ltd/images/2020/07/04/tuple.webp">
<meta property="og:image" content="https://www.yooo.ltd/images/2019-03-08.01.png">
<meta property="og:image" content="https://www.yooo.ltd/images/2019-03-08.02.png">
<meta property="og:image" content="https://www.yooo.ltd/images/2019-03-08.03.png">
<meta property="article:published_time" content="2024-03-18T11:19:58.000Z">
<meta property="article:modified_time" content="2024-03-19T19:04:01.000Z">
<meta property="article:author" content="Hai-Wei Chai (柴海伟)">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s21.ax1x.com/2024/10/17/pAUMSfI.png">


<link rel="canonical" href="https://hwchai.com/PythonLes03/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://hwchai.com/PythonLes03/","path":"PythonLes03/","title":"Python在科研中的应用 02：函数、流程控制语句与NumPy初步"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Python在科研中的应用 02：函数、流程控制语句与NumPy初步 | Hai-Wei Chai's Blog</title>
  







<link rel="dns-prefetch" href="https://vercel.hwchai.com/">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hai-Wei Chai's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-house-chimney fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-list fa-fw"></i>Archives</a></li><li class="menu-item menu-item-support"><a href="/support/" rel="section"><i class="fa fa-screwdriver-wrench fa-fw"></i>Support</a></li><li class="menu-item menu-item-books"><a href="/books/" rel="section"><i class="fa fa-book fa-fw"></i>Books</a></li><li class="menu-item menu-item-scholar"><a href="/scholar/" rel="section"><i class="fa fa-chart-column fa-fw"></i>Scholar</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Python%E8%AF%AD%E8%A8%80%E7%BC%A9%E8%BF%9B%E8%A7%84%E5%88%99"><span class="nav-number">1.</span> <span class="nav-text">Python语言缩进规则</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%BB%93"><span class="nav-number">1.1.</span> <span class="nav-text">本章小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.</span> <span class="nav-text">Python 流程控制语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#if-%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.1.</span> <span class="nav-text">if 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for-%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.2.</span> <span class="nav-text">for 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#range-%E5%87%BD%E6%95%B0"><span class="nav-number">2.3.</span> <span class="nav-text">range() 函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#break-%E5%92%8C-continue-%E8%AF%AD%E5%8F%A5-%E4%BB%A5%E5%8F%8A%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84-else-%E5%AD%90%E5%8F%A5"><span class="nav-number">2.4.</span> <span class="nav-text">break 和 continue 语句, 以及循环中的 else 子句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pass-%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.5.</span> <span class="nav-text">pass 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%BB%93-1"><span class="nav-number">2.6.</span> <span class="nav-text">本章小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0"><span class="nav-number">3.</span> <span class="nav-text">Python语言中的函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%87%BD%E6%95%B0"><span class="nav-number">3.1.</span> <span class="nav-text">创建函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.</span> <span class="nav-text">调用函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E4%B8%AD%E7%9A%84%E5%8F%82%E6%95%B0"><span class="nav-number">3.3.</span> <span class="nav-text">函数中的参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E5%80%BC"><span class="nav-number">3.4.</span> <span class="nav-text">默认参数值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97%E5%8F%82%E6%95%B0"><span class="nav-number">3.5.</span> <span class="nav-text">关键字参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8"><span class="nav-number">3.6.</span> <span class="nav-text">可变参数列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8%E7%9A%84%E5%88%86%E6%8B%86"><span class="nav-number">3.7.</span> <span class="nav-text">参数列表的分拆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Lambda-%E5%BD%A2%E5%BC%8F"><span class="nav-number">3.8.</span> <span class="nav-text">Lambda 形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E4%B8%AD%E7%9A%84%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E6%B7%B1%E5%85%A5%E8%A7%A3%E6%9E%90"><span class="nav-number">3.9.</span> <span class="nav-text">函数中的参数传递深入解析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NumPy%E5%88%9D%E6%AD%A5"><span class="nav-number">4.</span> <span class="nav-text">NumPy初步</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NumPy%E5%AE%89%E8%A3%85"><span class="nav-number">4.1.</span> <span class="nav-text">NumPy安装</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python-%E4%BB%A3%E7%A0%81%E7%9A%84%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="nav-number">5.</span> <span class="nav-text">Python 代码的性能分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#time%E5%91%BD%E4%BB%A4"><span class="nav-number">5.1.</span> <span class="nav-text">time命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#time%E5%BA%93"><span class="nav-number">5.2.</span> <span class="nav-text">time库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#time%E5%BA%93-%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8"><span class="nav-number">5.3.</span> <span class="nav-text">time库+上下文管理器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#time%E5%BA%93-%E5%87%BD%E6%95%B0%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="nav-number">5.4.</span> <span class="nav-text">time库+函数装饰器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#timeit%E5%BA%93"><span class="nav-number">5.5.</span> <span class="nav-text">timeit库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cProfile"><span class="nav-number">5.6.</span> <span class="nav-text">cProfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E9%87%8C%E4%BD%BF%E7%94%A8cProfile"><span class="nav-number">5.7.</span> <span class="nav-text">代码里使用cProfile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cProfile%E7%BB%93%E6%9E%9C%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="nav-number">5.8.</span> <span class="nav-text">cProfile结果可视化</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hai-Wei Chai (柴海伟)"
      src="/images/gamersky.gif">
  <p class="site-author-name" itemprop="name">Hai-Wei Chai (柴海伟)</p>
  <div class="site-description" itemprop="description">I am a slow walker, but never backwards!</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/haiweichai" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;haiweichai" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:chw9402@mail.ustc.edu.com" title="E-Mail → mailto:chw9402@mail.ustc.edu.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://hwchai.com/PythonLes03/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/gamersky.gif">
      <meta itemprop="name" content="Hai-Wei Chai (柴海伟)">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hai-Wei Chai's Blog">
      <meta itemprop="description" content="I am a slow walker, but never backwards!">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Python在科研中的应用 02：函数、流程控制语句与NumPy初步 | Hai-Wei Chai's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Python在科研中的应用 02：函数、流程控制语句与NumPy初步
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-03-18 11:19:58" itemprop="dateCreated datePublished" datetime="2024-03-18T11:19:58Z">2024-03-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-03-19 19:04:01" itemprop="dateModified" datetime="2024-03-19T19:04:01Z">2024-03-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming-language/" itemprop="url" rel="index"><span itemprop="name">Programming language</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline: </span>
  
    <a title="waline" href="/PythonLes03/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/PythonLes03/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><img src="https://s21.ax1x.com/2024/10/17/pAUMSfI.png"></p>
<p>通过前面两周课程的学习，我们了解了现代科研体系中编程语言的必要作用，而Python等解释型语言由于其便捷易开发的优势又是其中的主力军之一。以及对Python语言的基础知识包括注释、对象类型（数字、字符串、布尔型等）、运算符（位运算符、赋值运算符、逻辑运算符）等。第三周课程我们将学习Python语言编写时的缩进规则、函数的用法、流程控制语句以及NumPy模块的初步使用。</p>
<span id="more"></span>

<h2 id="Python语言缩进规则"><a href="#Python语言缩进规则" class="headerlink" title="Python语言缩进规则"></a>Python语言缩进规则</h2><p>和其它程序设计语言采用大括号 <code>&#123;&#125;</code> 分隔代码块不同，Python 采用代码缩进和冒号来区分代码块之间的层次。 要求严格的代码缩进是Python语法的一大特色，好比C语言中的花括号一样重要。</p>
<p>在 Python 中，对于 $\lfloor$类$\rceil$、$\lfloor$函数$\rceil$、$\lfloor$流程控制语句$\rceil$、$\lfloor$异常处理语句$\rceil$ 等，行尾的冒号和下一行的缩进，表示下一个代码块的开始，而缩进的结束则表示此代码块的结束。</p>
<p>在python中，强制要求缩进，一般使用<code>Tab</code>或<code>Space</code>来进行缩进，且缩进必须要保持一致，否则可能会出缩进的错误。官方规定是缩进四个空格，而<code>Tab</code>键不一定等于四个空格，所以需要设置一个<code>Tab</code>等于四个空格。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">dataInfo</span>(<span class="params">filename,showInfor=<span class="literal">False</span></span>):</span><br><span class="line">    f = h5py.File(filename,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:    </span><br><span class="line">        arr = f[<span class="string">&quot;exchange/data&quot;</span>] </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;!!!!! Infor !!!!!&#x27;</span>)</span><br><span class="line">        dim = arr.shape</span><br><span class="line">        <span class="keyword">if</span> showInfor == <span class="literal">True</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Data dimension is [Theta:Y:X] = [&#x27;</span>, dim[<span class="number">0</span>],<span class="string">&#x27;:&#x27;</span>, dim[<span class="number">1</span>],<span class="string">&#x27;:&#x27;</span>, dim[<span class="number">2</span>],<span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">        arr = f[<span class="string">&quot;exchange/data_white&quot;</span>]</span><br><span class="line">        <span class="keyword">if</span> arr.shape[<span class="number">0</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;!!!!! Infor !!!!!&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;There is no white images in this file.&#x27;</span>)</span><br><span class="line">        arr = f[<span class="string">&quot;exchange/data_dark&quot;</span>] </span><br><span class="line">        <span class="keyword">if</span> arr.shape[<span class="number">0</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;!!!!! Infor !!!!!&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;There is no dark images in this file.&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> dim    </span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;!!!!! Error !!!!!&#x27;</span>) </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Dataset \&#x27;exchange/data\&#x27; does not exist in the give file.&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>与其他语言不同，Python属于强制缩进的，它这种做法属于双刃剑，有好处也有坏处。</p>
<p>好处是强迫你写出格式化的代码，但没有规定缩进是几个空格还是<code>Tab</code>。按照约定俗成的管理，应该始终坚持使用四个空格的缩进；另一个好处是强迫你写出缩进较少的代码，你会倾向于将一段很长的代码拆分成若干函数，从而得到缩进较少的代码。</p>
<p>坏处就是复制、粘贴功能失效了，当你重构代码时，粘贴过去的代码必须重新检查缩进是否正确；此外，IDE很难像格式化Java代码那样格式化Python代码。</p>
<h3 id="本章小结"><a href="#本章小结" class="headerlink" title="本章小结"></a>本章小结</h3><blockquote class="blockquote-center">
<p>Python使用缩进来组织代码块，区分$\lfloor$类$\rceil$、$\lfloor$函数$\rceil$、$\lfloor$流程控制语句$\rceil$、$\lfloor$异常处理语句$\rceil$等的层次，请务必遵守约定俗成的习惯，坚持使用4个空格的缩进。在文本编辑器中，需要设置把<code>Tab</code>自动转换为4个空格，确保不混用<code>tab</code>和空格。 </p>

</blockquote>


<h2 id="Python-流程控制语句"><a href="#Python-流程控制语句" class="headerlink" title="Python 流程控制语句"></a>Python 流程控制语句</h2><p>我们可以使用 Python 来执行一些稍复杂的任务。例如，我们可以写一个生成菲波那契子序列的程序，如下所示:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Fibonacci series:</span></span><br><span class="line"><span class="comment"># the sum of two elements defines the next</span></span><br><span class="line">a, b = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> b &lt; <span class="number">10</span>:</span><br><span class="line">    <span class="built_in">print</span>(b)</span><br><span class="line">    a, b = b, a+b</span><br></pre></td></tr></table></figure>

<p>这个例子介绍了几个新功能。</p>
<ul>
<li><p>第一行包括了一个 多重赋值：变量 a 和 b 同时获得了新的值 0 和 1 最后一行又使用了一次。在这个演示中，变量赋值前，右边首先完成计算。右边的表达式从左到右计算。</p>
</li>
<li><p>条件（这里是 b &lt; 10 ）为 true 时， while 循环执行。在 Python 中，类似于 C，任何非零整数都是 True；0 是 False。条件也可以是字符串或列表，实际上可以是任何序列；</p>
</li>
<li><p>循环体是缩进的：缩进是 Python 组织语句的方法。</p>
</li>
</ul>
<p>除了这里介绍的 while 语句，Python 还从其它语言借鉴了一些流程控制功能，并有所改变。</p>
<img src="https://docs.sunfounder.com/projects/thales-kit/en/latest/_images/while_loop.png" width="40%" alt="while语句逻辑结构" align=center />


<h3 id="if-语句"><a href="#if-语句" class="headerlink" title="if 语句"></a>if 语句</h3><p>也许最有名的是 if 语句。例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Please enter an integer: &quot;</span>))</span><br><span class="line">Please enter an integer: <span class="number">42</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> x &lt; <span class="number">0</span>:</span><br><span class="line"><span class="meta">... </span>     x = <span class="number">0</span></span><br><span class="line"><span class="meta">... </span>     <span class="built_in">print</span>(<span class="string">&#x27;Negative changed to zero&#x27;</span>)</span><br><span class="line"><span class="meta">... </span><span class="keyword">elif</span> x == <span class="number">0</span>:</span><br><span class="line"><span class="meta">... </span>     <span class="built_in">print</span>(<span class="string">&#x27;Zero&#x27;</span>)</span><br><span class="line"><span class="meta">... </span><span class="keyword">elif</span> x == <span class="number">1</span>:</span><br><span class="line"><span class="meta">... </span>     <span class="built_in">print</span>(<span class="string">&#x27;Single&#x27;</span>)</span><br><span class="line"><span class="meta">... </span><span class="keyword">else</span>:</span><br><span class="line"><span class="meta">... </span>     <span class="built_in">print</span>(<span class="string">&#x27;More&#x27;</span>)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>可能会有零到多个<code>elif</code>部分，<code>else</code>是可选的。关键字<code>elif</code>是else if的缩写，这个可以有效地避免过深的缩进。&#96;if … elif … elif …&#96;&#96; 序列用于替代其它语言中的 switch 或 case 语句。</p>
<img src="https://docs.sunfounder.com/projects/thales-kit/en/latest/_images/if_elif_else.png" width="60%" alt="if ... elif ... else ... 逻辑结构，elif 与 else为可选项" align=center />

<p>我们可以将一个if语句嵌入到另一个if语句中，然后称之为嵌套if语句。事实上，所有的流程控制语句都可以多层嵌套。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">67</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">10</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Above ten,&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">20</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;and also above 20!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;but not above 20.&quot;</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;python3 exampleCode.py</span><br><span class="line">&gt;&gt;&gt;Above ten,</span><br><span class="line">&gt;&gt;&gt;<span class="keyword">and</span> also above <span class="number">20</span>!</span><br></pre></td></tr></table></figure>

<h3 id="for-语句"><a href="#for-语句" class="headerlink" title="for 语句"></a>for 语句</h3><p>Python 中的 for 语句和 C 或 Pascal 中的略有不同。通常的循环可能会依据一个等差数值步进过程（如 Pascal），或由用户来定义迭代步骤和中止条件（如 C ），Python 的 for 语句依据任意序列（链表或字符串）中的子项，按它们在序列中的顺序来进行迭代。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Measure some strings:</span></span><br><span class="line"><span class="meta">... </span>words = [<span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;window&#x27;</span>, <span class="string">&#x27;defenestrate&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> w <span class="keyword">in</span> words:</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(w, <span class="built_in">len</span>(w))</span><br><span class="line">...</span><br><span class="line">cat <span class="number">3</span></span><br><span class="line">window <span class="number">6</span></span><br><span class="line">defenestrate <span class="number">12</span></span><br></pre></td></tr></table></figure>

<img src="https://docs.sunfounder.com/projects/thales-kit/en/latest/_images/for_loop.png" width="45%" alt="for语句逻辑结构" align=center />

<p>在迭代过程中修改迭代序列不安全（只有在使用链表这样的可变序列时才会有这样的情况）。如果你想要修改你迭代的序列（例如，复制选择项），你可以迭代它的复本。使用切割标识就可以很方便的做到这一点:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> w <span class="keyword">in</span> words[:]:  <span class="comment"># Loop over a slice copy of the entire list.</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">if</span> <span class="built_in">len</span>(w) &gt; <span class="number">6</span>:</span><br><span class="line"><span class="meta">... </span>        words.insert(<span class="number">0</span>, w)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>words</span><br><span class="line">[<span class="string">&#x27;defenestrate&#x27;</span>, <span class="string">&#x27;cat&#x27;</span>, <span class="string">&#x27;window&#x27;</span>, <span class="string">&#x27;defenestrate&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="range-函数"><a href="#range-函数" class="headerlink" title="range() 函数"></a>range() 函数</h3><p>如果你需要一个数值序列，内置函数<code>range()</code>会很方便，它生成一个等差级数链表:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(i)</span><br><span class="line">...</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>

<p><code>range(10)</code>生成了一个包含 10 个值的链表，它用链表的索引值填充了这个长度为 10 的列表，所生成的链表中不包括范围中的结束值。也可以让 range() 操作从另一个数值开始，或者可以指定一个不同的步进值（甚至是负数，有时这也被称为 “步长”）:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">range</span>(<span class="number">5</span>, <span class="number">10</span>)</span><br><span class="line">   <span class="number">5</span> through <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10</span>, <span class="number">3</span>)</span><br><span class="line">   <span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">range</span>(-<span class="number">10</span>, -<span class="number">100</span>, -<span class="number">30</span>)</span><br><span class="line">  -<span class="number">10</span>, -<span class="number">40</span>, -<span class="number">70</span></span><br></pre></td></tr></table></figure>

<p>需要迭代链表索引的话，如下所示结合使用<code>range()</code>和<code>len()</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="string">&#x27;Mary&#x27;</span>, <span class="string">&#x27;had&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;little&#x27;</span>, <span class="string">&#x27;lamb&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(i, a[i])</span><br><span class="line">...</span><br><span class="line"><span class="number">0</span> Mary</span><br><span class="line"><span class="number">1</span> had</span><br><span class="line"><span class="number">2</span> a</span><br><span class="line"><span class="number">3</span> little</span><br><span class="line"><span class="number">4</span> lamb</span><br></pre></td></tr></table></figure>

<p>不过，这种场合可以方便的使用<code>enumerate()</code>。在序列中循环时，索引位置和对应值可以使用<code>enumerate()</code>函数同时得到:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>([<span class="string">&#x27;tic&#x27;</span>, <span class="string">&#x27;tac&#x27;</span>, <span class="string">&#x27;toe&#x27;</span>]):</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(i, v)</span><br><span class="line">...</span><br><span class="line"><span class="number">0</span> tic</span><br><span class="line"><span class="number">1</span> tac</span><br><span class="line"><span class="number">2</span> toe</span><br></pre></td></tr></table></figure>

<p>如果你只是打印一个序列的话会发生奇怪的事情:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; print(range(10))</span><br><span class="line">range(0, 10)</span><br></pre></td></tr></table></figure>

<p>在不同方面 range() 函数返回的对象表现为它是一个列表，但事实上它并不是。当你迭代它时，它是一个能够像期望的序列返回连续项的对象；但为了节省空间，它并不真正构造列表。</p>
<p>我们称此类对象是 可迭代的，即适合作为那些期望从某些东西中获得连续项直到结束的函数或结构的一个目标（参数）。我们已经见过的 for 语句就是这样一个迭代器。list() 函数是另外一个（ 迭代器 ），它从可迭代（对象）中创建列表:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">5</span>))</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<p>以后的学习中我们会看到更多返回可迭代（对象）和以可迭代（对象）作为参数的函数。</p>
<h3 id="break-和-continue-语句-以及循环中的-else-子句"><a href="#break-和-continue-语句-以及循环中的-else-子句" class="headerlink" title="break 和 continue 语句, 以及循环中的 else 子句"></a>break 和 continue 语句, 以及循环中的 else 子句</h3><p>break 语句和 C 中的类似，用于跳出最近的一级 for 或 while 循环。</p>
<p>循环可以有一个 else 子句；它在循环迭代完整个列表（对于 for ）或执行条件为 false （对于 while ）时执行，但循环被 break 中止的情况下不会执行。以下搜索素数的示例程序演示了这个过程:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">10</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n):</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">if</span> n % x == <span class="number">0</span>:</span><br><span class="line"><span class="meta">... </span>            <span class="built_in">print</span>(n, <span class="string">&#x27;equals&#x27;</span>, x, <span class="string">&#x27;*&#x27;</span>, n//x)</span><br><span class="line"><span class="meta">... </span>            <span class="keyword">break</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">else</span>:</span><br><span class="line"><span class="meta">... </span>        <span class="comment"># loop fell through without finding a factor</span></span><br><span class="line"><span class="meta">... </span>        <span class="built_in">print</span>(n, <span class="string">&#x27;is a prime number&#x27;</span>)</span><br><span class="line">...</span><br><span class="line"><span class="number">2</span> <span class="keyword">is</span> a prime number</span><br><span class="line"><span class="number">3</span> <span class="keyword">is</span> a prime number</span><br><span class="line"><span class="number">4</span> equals <span class="number">2</span> * <span class="number">2</span></span><br><span class="line"><span class="number">5</span> <span class="keyword">is</span> a prime number</span><br><span class="line"><span class="number">6</span> equals <span class="number">2</span> * <span class="number">3</span></span><br><span class="line"><span class="number">7</span> <span class="keyword">is</span> a prime number</span><br><span class="line"><span class="number">8</span> equals <span class="number">2</span> * <span class="number">4</span></span><br><span class="line"><span class="number">9</span> equals <span class="number">3</span> * <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>(Yes, 这是正确的代码。看仔细：else 语句是属于 for 循环之中， 不是 if 语句。)</p>
<ul>
<li>与循环一起使用时，else 子句与 try 语句的 else 子句比与 if 语句的具有更多的共同点：try 语句的 else 子句在未出现异常时运行，循环的 else 子句在未出现 break 时运行。</li>
</ul>
<p>continue 语句是从 C 中借鉴来的，它表示循环继续执行下一次迭代:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">10</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">if</span> num % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line"><span class="meta">... </span>        <span class="built_in">print</span>(<span class="string">&quot;Found an even number&quot;</span>, num)</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">continue</span></span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&quot;Found a number&quot;</span>, num)</span><br><span class="line">Found an even number <span class="number">2</span></span><br><span class="line">Found a number <span class="number">3</span></span><br><span class="line">Found an even number <span class="number">4</span></span><br><span class="line">Found a number <span class="number">5</span></span><br><span class="line">Found an even number <span class="number">6</span></span><br><span class="line">Found a number <span class="number">7</span></span><br><span class="line">Found an even number <span class="number">8</span></span><br><span class="line">Found a number <span class="number">9</span></span><br></pre></td></tr></table></figure>

<h3 id="pass-语句"><a href="#pass-语句" class="headerlink" title="pass 语句"></a>pass 语句</h3><p>pass 语句什么也不做。它用于那些语法上必须要有什么语句，但程序什么也不做的场合，例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">pass</span>  <span class="comment"># Busy-wait for keyboard interrupt (Ctrl+C)</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>这通常用于创建最小结构的类:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">class</span> <span class="title class_">MyEmptyClass</span>:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">pass</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>另一方面，pass 可以在创建新代码时用来做函数或控制体的占位符。可以让你在更抽象的级别上思考。pass 可以默默的被忽视:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">initlog</span>(<span class="params">*args</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">pass</span>   <span class="comment"># Remember to implement this!</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="本章小结-1"><a href="#本章小结-1" class="headerlink" title="本章小结"></a>本章小结</h3><blockquote class="blockquote-center">
<p>通过本节的学习，我们了解了Python中的流程控制语句，包括if … elif … else …结构，while结构以及for循环的基本使用方法，以及与之配合的range()函数及break\continue语句的使用规则。 </p>

</blockquote>























<h2 id="Python语言中的函数"><a href="#Python语言中的函数" class="headerlink" title="Python语言中的函数"></a>Python语言中的函数</h2><p>在编程中，函数是一种模块化的手段，当它被调用时执行特定功能并提供反馈。可提高代码的利用率，避免重复代码，便于使用，便于维护。Python 中，不仅提供了许多现成可用的内建函数，用户还可以根据自己的需求，定义自己的函数。</p>
<p>函数也属于一种数据类型，可以使用<code>type()</code>查看，内建函数为<code>builtin_function_or_method</code>，自定义函数为<code>function</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">printhello</span>(): <span class="comment"># 自定义函数 test()，并没有实质功能</span></span><br><span class="line"><span class="meta">... </span>   <span class="built_in">print</span>(<span class="string">&#x27;Hello world!!!&#x27;</span>)</span><br><span class="line"><span class="meta">... </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(printhello)  <span class="comment"># printhello() 为自定义函数</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;function&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(<span class="built_in">print</span>)       <span class="comment"># print() 为内建函数</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;builtin_function_or_method&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>本章节将展示如何在Python中定义函数并调用它，这样你就可以把Python应用程序的代码模块化分解，重复利用，精简代码结构。</p>
<h3 id="创建函数"><a href="#创建函数" class="headerlink" title="创建函数"></a>创建函数</h3><p>创建函数也称为定义函数，可以理解为创建一个具有某种用途的工具，通过<code>def</code>关键词及函数标识符（函数对象名）实现，具体的语法格式如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">functionName</span>(<span class="params">parameterList</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;comments&#x27;&#x27;&#x27;</span></span><br><span class="line">    functionBody</span><br></pre></td></tr></table></figure>

<p>这里包括四个函数的基本元素：</p>
<ul>
<li>functionName: 函数名称，在调用函数时使用。</li>
<li>parameterlist: 可选参数，用于指定像函数中传递的参数。如果有多个参数，则各参数间使用逗号<code>,</code>分隔；如果不指定，则表示该函数没有输入参数。</li>
<li>comments: 可选参数，标识为函数指定注释。也称为Docstrings（文档字符串），通常用于说明该函数的功能、要传递的参数的作用等等。</li>
<li>functionBody: 函数体，实现函数的功能的具体代码块。如果函数有返回值，可以使用return语句返回。</li>
</ul>
<p>函数体“functionBody”与注释“comments”相对于def关键字必须保持缩进。</p>
<p>按照上面的基本语法，一个向终端输出随机生成的两个变量之和的Python函数示例如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">myfunction</span>():</span><br><span class="line">	a = rand()</span><br><span class="line">	b = rand()</span><br><span class="line">    <span class="built_in">print</span>(a+b)</span><br></pre></td></tr></table></figure>

<p>我们举一个工程应用中具体的例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">update_image</span>(<span class="params">self, geo, angle, iteration</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    VERBOSE:</span></span><br><span class="line"><span class="string">     for j in range(angleblocks):</span></span><br><span class="line"><span class="string">         angle = np.array([alpha[j]], dtype=np.float32)</span></span><br><span class="line"><span class="string">         proj_err = proj[angle_index[j]] - Ax(res, geo, angle, &#x27;ray-voxel&#x27;)</span></span><br><span class="line"><span class="string">         backprj = Atb(proj_err, geo, angle, &#x27;FDK&#x27;)</span></span><br><span class="line"><span class="string">         res += backprj</span></span><br><span class="line"><span class="string">         res[res&lt;0]=0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :return: None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="variable language_">self</span>.res += <span class="variable language_">self</span>.__bm__ * <span class="number">2</span> * tigre.Atb((<span class="variable language_">self</span>.proj[<span class="variable language_">self</span>.angle_index[iteration]] - tigre.Ax(</span><br><span class="line">        <span class="variable language_">self</span>.res, geo, angle, <span class="string">&#x27;interpolated&#x27;</span>)), geo, angle, <span class="string">&#x27;matched&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_main_iter</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Goes through the main iteration for the given configuration.</span></span><br><span class="line"><span class="string">    :return: None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    t = <span class="variable language_">self</span>.__t__</span><br><span class="line">    Quameasopts = <span class="variable language_">self</span>.Quameasopts</span><br><span class="line">    x_rec = copy.deepcopy(<span class="variable language_">self</span>.res)</span><br><span class="line">    lambdaForTv = <span class="number">2</span> * <span class="variable language_">self</span>.__bm__ * <span class="variable language_">self</span>.__lambda__</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.niter):</span><br><span class="line"></span><br><span class="line">        res_prev = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> Quameasopts <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            res_prev = copy.deepcopy(<span class="variable language_">self</span>.res)</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.verbose:</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(<span class="variable language_">self</span>.name).upper() +</span><br><span class="line">                      <span class="string">&#x27; &#x27;</span> + <span class="string">&quot;algorithm in progress.&quot;</span>)</span><br><span class="line">                toc = default_timer()</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">                tic = default_timer()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Esitmated time until completetion (s): &#x27;</span> +</span><br><span class="line">                      <span class="built_in">str</span>((<span class="variable language_">self</span>.niter - <span class="number">1</span>) * (tic - toc)))</span><br><span class="line">        <span class="built_in">getattr</span>(<span class="variable language_">self</span>, <span class="variable language_">self</span>.dataminimizing)()</span><br><span class="line"></span><br><span class="line">        x_rec_old = copy.deepcopy(x_rec)</span><br><span class="line">        x_rec = im3ddenoise(<span class="variable language_">self</span>.res, <span class="variable language_">self</span>.__numiter_tv__, <span class="number">1.</span> / lambdaForTv)</span><br><span class="line">        t_old = t</span><br><span class="line">        t = (<span class="number">1</span> + np.sqrt(<span class="number">1</span> + <span class="number">4</span> * t ** <span class="number">2</span>)) / <span class="number">2</span></span><br><span class="line">        <span class="variable language_">self</span>.res = x_rec + (t_old - <span class="number">1</span>) / t * (x_rec - x_rec_old)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.error_measurement(res_prev, i)</span><br></pre></td></tr></table></figure>

<p>在Python2.X的版本中，如果定义的函数暂时什么都不做，那么需要使用pass关键字作为点位符，或者添加Docstrings，但不可以直接添加一行单行注释，示例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">functionNull</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;空函数在Python2.x版本中pass是必须的&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">functionNull</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;在Python3.x的时候pass可以写或不写&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<h3 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h3><p>调用函数也就是执行函数，调用函数的基本语法格式如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">functionNmae(parameterValue)</span><br></pre></td></tr></table></figure>

<p>共包括两个基本元素：</p>
<ul>
<li>functionName: 函数名称，要调用的函数名称必须是已经创建好的。</li>
<li>parameterValue: 指定函数需求输入的各个参数的值。如果有多个参数，则各参数间使用逗号<code>,</code>分隔；如函数无需参数输入，也必须写一对小括号在此。</li>
</ul>
<p>例如调用一个向终端输出两个随机变量之和的Python函数示例如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">myfunction</span>():</span><br><span class="line">	a = rand()</span><br><span class="line">	b = rand()</span><br><span class="line">    <span class="built_in">print</span>(a+b)</span><br><span class="line"></span><br><span class="line">myfunction()</span><br></pre></td></tr></table></figure>

<p>在Python中我们可以使用<code>return</code>关键字，从函数中向外反馈一些参数。<code>return</code>语句可以包含一个要执行的表达式。下面的例子演示了<code>return</code>关键字在 Python 中的作用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">multiplyNum</span>(<span class="params">num1</span>):</span><br><span class="line">    <span class="keyword">return</span> num1 * <span class="number">8</span></span><br><span class="line"></span><br><span class="line">result = multiplyNum(<span class="number">8</span>)</span><br><span class="line"><span class="built_in">print</span>(result)      <span class="comment"># 输出：64</span></span><br></pre></td></tr></table></figure>

<h3 id="函数中的参数"><a href="#函数中的参数" class="headerlink" title="函数中的参数"></a>函数中的参数</h3><p>在 Python 中，你也可以定义包含若干参数的函数。这里有三种可用的形式，也可以混合使用。第一种就是规规矩矩的按照位置准确传递参数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ask_ok</span>(<span class="params">prompt, retries, complaint</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        ok = <span class="built_in">input</span>(prompt)</span><br><span class="line">        <span class="keyword">if</span> ok <span class="keyword">in</span> (<span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;ye&#x27;</span>, <span class="string">&#x27;yes&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> ok <span class="keyword">in</span> (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;no&#x27;</span>, <span class="string">&#x27;nop&#x27;</span>, <span class="string">&#x27;nope&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        retries = retries - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> retries &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> OSError(<span class="string">&#x27;uncooperative user&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(complaint)</span><br><span class="line"></span><br><span class="line">ask_ok(<span class="string">&#x27;OK to overwrite the file?&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;Come on, only yes or no!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="默认参数值"><a href="#默认参数值" class="headerlink" title="默认参数值"></a>默认参数值</h3><p>此外最常用的一种形式是为一个或多个参数指定默认值。这会创建一个可以使用比定义时允许的参数更少的参数调用的函数，例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ask_ok</span>(<span class="params">prompt, retries=<span class="number">4</span>, complaint=<span class="string">&#x27;Yes or no, please!&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        ok = <span class="built_in">input</span>(prompt)</span><br><span class="line">        <span class="keyword">if</span> ok <span class="keyword">in</span> (<span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;ye&#x27;</span>, <span class="string">&#x27;yes&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> ok <span class="keyword">in</span> (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;no&#x27;</span>, <span class="string">&#x27;nop&#x27;</span>, <span class="string">&#x27;nope&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        retries = retries - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> retries &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> OSError(<span class="string">&#x27;uncooperative user&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(complaint)</span><br></pre></td></tr></table></figure>

<p>这个函数可以通过几种不同的方式调用:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 只给出必要的参数:</span></span><br><span class="line">ask_ok(<span class="string">&#x27;Do you really want to quit?&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给出一个可选的参数:</span></span><br><span class="line">ask_ok(<span class="string">&#x27;OK to overwrite the file?&#x27;</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者给出所有的参数:</span></span><br><span class="line">ask_ok(<span class="string">&#x27;OK to overwrite the file?&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;Come on, only yes or no!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这个例子还介绍了<code>in</code>关键字。它测定序列中是否包含某个确定的值。</p>
<p>默认值在函数定义作用域被解析，如下所示:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">arg=i</span>):</span><br><span class="line">    <span class="built_in">print</span>(arg)</span><br><span class="line"></span><br><span class="line">i = <span class="number">6</span></span><br><span class="line">f()      <span class="comment"># 将会输出 5。</span></span><br></pre></td></tr></table></figure>

<p>重要警告: 默认值只被赋值一次。这使得当默认值是可变对象时会有所不同，比如列表、字典或者大多数类的实例。例如，下面的函数在后续调用过程中会累积（前面）传给它的参数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">a, L=[]</span>):</span><br><span class="line">    L.append(a)</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f(<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(f(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(f(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">1</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<p>如果你不想让默认值在后续调用中累积，你可以像下面一样定义函数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">a, L=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> L <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        L = []</span><br><span class="line">    L.append(a)</span><br><span class="line">    <span class="keyword">return</span> L</span><br></pre></td></tr></table></figure>

<h3 id="关键字参数"><a href="#关键字参数" class="headerlink" title="关键字参数"></a>关键字参数</h3><p>函数可以通过 关键字参数 的形式来调用，形如 <code>keyword = value</code>。例如，以下的函数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">parrot</span>(<span class="params">voltage, state=<span class="string">&#x27;a stiff&#x27;</span>, action=<span class="string">&#x27;voom&#x27;</span>, <span class="built_in">type</span>=<span class="string">&#x27;Norwegian Blue&#x27;</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-- This parrot wouldn&#x27;t&quot;</span>, action, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;if you put&quot;</span>, voltage, <span class="string">&quot;volts through it.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-- Lovely plumage, the&quot;</span>, <span class="built_in">type</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-- It&#x27;s&quot;</span>, state, <span class="string">&quot;!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>接受一个必选参数 (voltage) 以及三个可选参数 (state, action, 和 type)。可以用以下的任一方法调用:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">parrot(<span class="number">1000</span>)                                          <span class="comment"># 1 positional argument</span></span><br><span class="line">parrot(voltage=<span class="number">1000</span>)                                  <span class="comment"># 1 keyword argument</span></span><br><span class="line">parrot(voltage=<span class="number">1000000</span>, action=<span class="string">&#x27;VOOOOOM&#x27;</span>)             <span class="comment"># 2 keyword arguments</span></span><br><span class="line">parrot(action=<span class="string">&#x27;VOOOOOM&#x27;</span>, voltage=<span class="number">1000000</span>)             <span class="comment"># 2 keyword arguments</span></span><br><span class="line">parrot(<span class="string">&#x27;a million&#x27;</span>, <span class="string">&#x27;bereft of life&#x27;</span>, <span class="string">&#x27;jump&#x27;</span>)         <span class="comment"># 3 positional arguments</span></span><br><span class="line">parrot(<span class="string">&#x27;a thousand&#x27;</span>, state=<span class="string">&#x27;pushing up the daisies&#x27;</span>)  <span class="comment"># 1 positional, 1 keyword</span></span><br></pre></td></tr></table></figure>

<p>不过以下几种调用是无效的:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parrot()                     <span class="comment"># required argument missing</span></span><br><span class="line">parrot(voltage=<span class="number">5.0</span>, <span class="string">&#x27;dead&#x27;</span>)  <span class="comment"># non-keyword argument after a keyword argument</span></span><br><span class="line">parrot(<span class="number">110</span>, voltage=<span class="number">220</span>)     <span class="comment"># duplicate value for the same argument</span></span><br><span class="line">parrot(actor=<span class="string">&#x27;John Cleese&#x27;</span>)  <span class="comment"># unknown keyword argument</span></span><br></pre></td></tr></table></figure>

<p>在函数调用中，关键字的参数必须跟随在位置参数的后面。传递的所有关键字参数必须与函数接受的某个参数相匹配 （例如 actor 不是 parrot 函数的有效参数），它们的顺序并不重要。这也包括非可选参数（例如 parrot(voltage&#x3D;1000) 也是有效的）。任何参数都不可以多次赋值。下面的示例由于这种限制将失败:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; def <span class="keyword">function</span>(a):</span></span><br><span class="line">...     pass</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; <span class="keyword">function</span>(0, a=0)</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;stdin&gt;&quot;, line 1, in ?</span><br><span class="line">TypeError: function() got multiple values for keyword argument &#x27;a&#x27;</span><br></pre></td></tr></table></figure>

<p>以下为可选阅读：</p>
<p>引入一个形如 <code>**name</code> 的参数时，它接收一个字典（参见 下一小节 ），该字典包含了所有未出现在形式参数列表中的关键字参数。这里可能还会组合使用一个形如 <code>*name</code> （下一小节详细介绍） 的形式参数，它接收一个元组（下一节中会详细介绍），包含了所有没有出现在形式参数列表中的参数值（ <code>*name</code> 必须在 <code>**name</code> 之前出现）。 例如，我们这样定义一个函数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cheeseshop</span>(<span class="params">kind, *arguments, **keywords</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-- Do you have any&quot;</span>, kind, <span class="string">&quot;?&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-- I&#x27;m sorry, we&#x27;re all out of&quot;</span>, kind)</span><br><span class="line">    <span class="keyword">for</span> arg <span class="keyword">in</span> arguments:</span><br><span class="line">        <span class="built_in">print</span>(arg)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">40</span>)</span><br><span class="line">    keys = <span class="built_in">sorted</span>(keywords.keys())</span><br><span class="line">    <span class="keyword">for</span> kw <span class="keyword">in</span> keys:</span><br><span class="line">        <span class="built_in">print</span>(kw, <span class="string">&quot;:&quot;</span>, keywords[kw])</span><br></pre></td></tr></table></figure>

<p>它可以像这样调用:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cheeseshop(<span class="string">&quot;Limburger&quot;</span>, <span class="string">&quot;It&#x27;s very runny, sir.&quot;</span>,</span><br><span class="line">           <span class="string">&quot;It&#x27;s really very, VERY runny, sir.&quot;</span>,</span><br><span class="line">           shopkeeper=<span class="string">&quot;Michael Palin&quot;</span>,</span><br><span class="line">           client=<span class="string">&quot;John Cleese&quot;</span>,</span><br><span class="line">           sketch=<span class="string">&quot;Cheese Shop Sketch&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>当然它会按如下内容打印:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- Do you have <span class="built_in">any</span> Limburger ?</span><br><span class="line">-- I<span class="string">&#x27;m sorry, we&#x27;</span>re <span class="built_in">all</span> out of Limburger</span><br><span class="line">It<span class="string">&#x27;s very runny, sir.</span></span><br><span class="line"><span class="string">It&#x27;</span>s really very, VERY runny, sir.</span><br><span class="line">----------------------------------------</span><br><span class="line">client : John Cleese</span><br><span class="line">shopkeeper : Michael Palin</span><br><span class="line">sketch : Cheese Shop Sketch</span><br></pre></td></tr></table></figure>

<p>注意在打印关键字参数之前，通过对关键字字典<code>keys()</code>方法的结果进行排序，生成了关键字参数名的列表；如果不这样做，打印出来的参数的顺序是未定义的。</p>
<h3 id="可变参数列表"><a href="#可变参数列表" class="headerlink" title="可变参数列表"></a>可变参数列表</h3><p>最后，一个最不常用的选择是可以让函数调用可变个数的参数。这些参数被包装进一个元组。在这些可变个数的参数之前，可以有零到多个普通的参数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">write_multiple_items</span>(<span class="params">file, separator, *args</span>):</span><br><span class="line">    file.write(separator.join(args))</span><br></pre></td></tr></table></figure>

<p>通常，这些 可变 参数是参数列表中的最后一个，因为它们将把所有的剩余输入参数传递给函数。任何出现在<code>*args</code>后的参数是关键字参数，这意味着，他们只能被用作关键字，而不是位置参数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">concat</span>(<span class="params">*args, sep=<span class="string">&quot;/&quot;</span></span>):</span><br><span class="line"><span class="meta">... </span>   <span class="keyword">return</span> sep.join(args)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>concat(<span class="string">&quot;earth&quot;</span>, <span class="string">&quot;mars&quot;</span>, <span class="string">&quot;venus&quot;</span>)</span><br><span class="line"><span class="string">&#x27;earth/mars/venus&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>concat(<span class="string">&quot;earth&quot;</span>, <span class="string">&quot;mars&quot;</span>, <span class="string">&quot;venus&quot;</span>, sep=<span class="string">&quot;.&quot;</span>)</span><br><span class="line"><span class="string">&#x27;earth.mars.venus&#x27;</span></span><br></pre></td></tr></table></figure>

<p>另一种形式是<code>**arg</code>作为关键词，表示接受任意多个显式赋值的实际参数，并将其放在一个字典之中。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">bar</span>(<span class="params">param1, **param2</span>):</span><br><span class="line">        <span class="built_in">print</span> param1</span><br><span class="line">        <span class="built_in">print</span> param2</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bar(<span class="number">1</span>,a=<span class="number">2</span>,b=<span class="number">3</span>)</span><br><span class="line"><span class="number">1</span></span><br><span class="line">&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure>

<p>当然这两种用法可以同时出现在一个函数之中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">a, b=<span class="number">10</span>, *args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span> a</span><br><span class="line">        <span class="built_in">print</span> b</span><br><span class="line">        <span class="built_in">print</span> args</span><br><span class="line">        <span class="built_in">print</span> kwargs</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, e=<span class="number">5</span>, f=<span class="number">6</span>, g=<span class="number">7</span>)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span> <span class="number">4</span></span><br><span class="line">&#123;<span class="string">&#x27;e&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;g&#x27;</span>: <span class="number">7</span>, <span class="string">&#x27;f&#x27;</span>: <span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure>


<h3 id="参数列表的分拆"><a href="#参数列表的分拆" class="headerlink" title="参数列表的分拆"></a>参数列表的分拆</h3><p>当大家在阅读如《Python从入门到精通》等丛书时，通常会介绍到当我们尝试把元组或字典直接输入给函数，可以分别使用<code>*arg</code>或<code>**arg</code>直接向函数输入。但这是为什么呢？</p>
<p>当你要传递的参数已经是一个列表，但要调用的函数却接受分开一个个的参数值。这时候你要把已有的列表拆开来。例如内建函数<code>range()</code>需要要独立的 start，stop参数。你可以在调用函数时加一个 * 操作符来自动把参数列表拆开:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">3</span>, <span class="number">6</span>))            <span class="comment"># normal call with separate arguments</span></span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>args = [<span class="number">3</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(<span class="built_in">range</span>(*args))            <span class="comment"># call with arguments unpacked from a list</span></span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br></pre></td></tr></table></figure>

<p>以同样的方式，可以使用 <code>**</code> 操作符分拆关键字参数为字典:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">parrot</span>(<span class="params">voltage, state=<span class="string">&#x27;a stiff&#x27;</span>, action=<span class="string">&#x27;voom&#x27;</span></span>):</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&quot;-- This parrot wouldn&#x27;t&quot;</span>, action, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&quot;if you put&quot;</span>, voltage, <span class="string">&quot;volts through it.&quot;</span>, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">&quot;E&#x27;s&quot;</span>, state, <span class="string">&quot;!&quot;</span>)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">&quot;voltage&quot;</span>: <span class="string">&quot;four million&quot;</span>, <span class="string">&quot;state&quot;</span>: <span class="string">&quot;bleedin&#x27; demised&quot;</span>, <span class="string">&quot;action&quot;</span>: <span class="string">&quot;VOOM&quot;</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>parrot(**d)</span><br><span class="line">-- This parrot wouldn<span class="string">&#x27;t VOOM if you put four million volts through it. E&#x27;</span>s bleedin<span class="string">&#x27; demised !</span></span><br></pre></td></tr></table></figure>

<h3 id="Lambda-形式"><a href="#Lambda-形式" class="headerlink" title="Lambda 形式"></a>Lambda 形式</h3><p>出于实际需要，有几种通常在函数式编程语言例如 Lisp 中出现的功能加入到了 Python。通过<code>lambda</code>关键字，可以创建短小的匿名函数。这里有一个函数返回它的两个参数的和： lambda a, b: a+b。 Lambda 形式可以用于任何需要的函数对象。出于语法限制，它们只能有一个单独的表达式。语义上讲，它们只是普通函数定义中的一个语法技巧。类似于嵌套函数定义，lambda 形式可以从外部作用域引用变量:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">make_incrementor</span>(<span class="params">n</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">return</span> <span class="keyword">lambda</span> x: x + n</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f = make_incrementor(<span class="number">42</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f(<span class="number">0</span>)</span><br><span class="line"><span class="number">42</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f(<span class="number">1</span>)</span><br><span class="line"><span class="number">43</span></span><br></pre></td></tr></table></figure>


<h3 id="函数中的参数传递深入解析"><a href="#函数中的参数传递深入解析" class="headerlink" title="函数中的参数传递深入解析"></a>函数中的参数传递深入解析</h3><p>在Python中定义一个函数时，可以通过把参数放在括号内将它们传入函数。调用函数时，需要为参数指定一个值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">addNum</span>(<span class="params">num1, num2</span>):</span><br><span class="line">    <span class="built_in">print</span>(num1 + num2)</span><br><span class="line"></span><br><span class="line">addNum(<span class="number">2</span>,<span class="number">4</span>)       <span class="comment"># 输出：6</span></span><br></pre></td></tr></table></figure>

<p>在上面的例子中，我向名为<code>addNum</code>的函数传递了两个参数，该函数将两个参数的和输出至终端。</p>
<h4 id="定位参数、关键字参数"><a href="#定位参数、关键字参数" class="headerlink" title="定位参数、关键字参数"></a>定位参数、关键字参数</h4><p>在Python中，当定义一个函数时，函数接收的参数叫做形式参数（parameters），以下简称形参；当调用一个函数时，调用语句传递给该函数的值叫做实际参数（arguments），以下简称实参。</p>
<p>根据<a target="_blank" rel="noopener" href="https://docs.python.org/3/library/inspect.html">$\lfloor$inspect模块$\rceil$</a> 的描述，Python的形参可以分成如下五类：</p>
<ul>
<li><code>POSITIONAL_OR_KEYWORD</code>，默认类型，可通过定位&#x2F;关键字实参传递；</li>
<li><code>VAR_POSITIONAL</code>，定位形参元祖，如<code>*args</code>，捕获剩下的定位实参；</li>
<li><code>KEYWORD_ONLY</code>，在<code>*</code>或<code>*args</code>之后的形参，只能通过关键字实参传递；</li>
<li><code>VAR_KEYWORD</code>，关键字形参字典，如<code>**kwargs</code>，捕获剩下的关键字实参；</li>
<li><code>POSITIONAL_ONLY</code>，只能通过定位实参传递，Python语法暂不支持，只有一些C函数（如divmod）使用。</li>
</ul>
<p>比如定义如下函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">a, *args</span>):</span><br><span class="line">    <span class="built_in">print</span>(a, args)</span><br></pre></td></tr></table></figure>

<p>其中形参a属于<code>POSITIONAL_OR_KEYWORD</code>，可通过定位&#x2F;关键字实参传递：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(<span class="number">1</span>)</span><br><span class="line"><span class="number">1</span> ()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(a=<span class="number">1</span>)</span><br><span class="line"><span class="number">1</span> ()</span><br></pre></td></tr></table></figure>

<p>满足形参<code>a</code>之后，剩余的定位实参将被<code>*args</code>以元组的形式捕获：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="number">1</span> (<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>再比如定义如下函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">a, *args, b, **kwargs</span>):</span><br><span class="line">    <span class="built_in">print</span>(a, args, b, kwargs)</span><br></pre></td></tr></table></figure>

<p>形参b属于KEYWORD_ONLY，因为它在<code>*args</code>之后定义：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(<span class="number">1</span>, b=<span class="number">2</span>)</span><br><span class="line"><span class="number">1</span> () <span class="number">2</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>满足形参b之后，剩余的关键字实参将被<code>**kwargs</code>以字典的形式捕获：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(<span class="number">1</span>, b=<span class="number">2</span>, c=<span class="number">3</span>)</span><br><span class="line"><span class="number">1</span> () <span class="number">2</span> &#123;<span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure>

<p>如果想定义<code>KEYWORD_ONLY</code>形参，但不想使用<code>VAR_POSITIONAL</code>形参（即<code>*args</code>），则可以在定义函数时单独的<code>*</code>号：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">a, *, b</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(a, b)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(<span class="number">1</span>, b=<span class="number">2</span>)</span><br><span class="line"><span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: foo() takes <span class="number">1</span> positional argument but <span class="number">2</span> were given</span><br></pre></td></tr></table></figure>

<h4 id="参数默认值"><a href="#参数默认值" class="headerlink" title="参数默认值"></a>参数默认值</h4><p>在定义函数时，我们可以给形参指定默认值，比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">a=<span class="number">1</span>, *args, b=<span class="number">2</span>, **kwargs</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(a, args, b, kwargs)</span><br><span class="line"><span class="meta">... </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo()</span><br><span class="line"><span class="number">1</span> () <span class="number">2</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是，形参的默认值存储在函数对象的__defaults__和__kwdefaults__属性里，而不是每次调用函数时动态生成，所以最好不要用可变对象充当形参的默认值。下面的例子就是反面教材：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">param=[]</span>):</span><br><span class="line"><span class="meta">... </span>    param.append(<span class="number">1</span>)</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="built_in">id</span>(param), param)</span><br><span class="line"><span class="meta">... </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="built_in">id</span>(foo.__defaults__[<span class="number">0</span>]), foo.__defaults__[<span class="number">0</span>])</span><br><span class="line"><span class="number">140009169940232</span> []</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo()</span><br><span class="line"><span class="number">140009169940232</span> [<span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo()</span><br><span class="line"><span class="number">140009169940232</span> [<span class="number">1</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<h4 id="获取关于参数的信息"><a href="#获取关于参数的信息" class="headerlink" title="获取关于参数的信息"></a>获取关于参数的信息</h4><p>内省指程序在运行时检查对象类型的一种能力，本节介绍的内容就属于函数内省的范围。假设有如下函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">a=<span class="number">1</span>, *args, b=<span class="number">2</span>, **kwargs</span>):</span><br><span class="line">    c = a</span><br><span class="line">    <span class="built_in">print</span>(c, args, b, kwargs)</span><br></pre></td></tr></table></figure>

<p>就像上一节中提到的，<code>foo</code>函数有<code>__defaults__</code>、<code>__kwdefaults__</code>属性，用于记录定位参数和关键字参数的默认值；有<code>__code__</code>属性，存储函数编译后的字节码信息，其中就包括参数的名称。通过这些属性，我们可以获取关于函数参数的信息：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo.__defaults__</span><br><span class="line">(<span class="number">1</span>,)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo.__kwdefaults__</span><br><span class="line">&#123;<span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo.__code__.co_varnames  <span class="comment"># 参数&amp;局部变量名称</span></span><br><span class="line">(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;args&#x27;</span>, <span class="string">&#x27;kwargs&#x27;</span>, <span class="string">&#x27;c&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo.__code__.co_argcount  <span class="comment"># 定位参数数量</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo.__code__.co_kwonlyargcount  <span class="comment"># 仅限关键字参数数量</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>但这样还是太原始、太不方便了。幸好，我们有更好的选择：Python内置的inspect模块。下面这个例子就提取了<code>foo</code>函数的签名，然后获取函数的参数信息：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> inspect <span class="keyword">import</span> signature</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sig = signature(foo)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sig</span><br><span class="line">&lt;Signature (a=<span class="number">1</span>, *args, b=<span class="number">2</span>, **kwargs)&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> name, param <span class="keyword">in</span> sig.parameters.items():</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">str</span>(param.kind):&lt;<span class="number">21</span>&#125;</span> : <span class="subst">&#123;param.name:&lt;<span class="number">6</span>&#125;</span> = <span class="subst">&#123;param.default&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="meta">... </span></span><br><span class="line">POSITIONAL_OR_KEYWORD : a      = <span class="number">1</span></span><br><span class="line">VAR_POSITIONAL        : args   = &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;</span><br><span class="line">KEYWORD_ONLY          : b      = <span class="number">2</span></span><br><span class="line">VAR_KEYWORD           : kwargs = &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>同时，inspect.Signature对象还有一个bind方法，该方法可以将一些对象绑定到函数的形参上，就像Python解释器在调用函数时做的那样。通过这种方法，框架可以在真正执行函数前验证参数，就像下面这个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bound = sig.bind(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, c=<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> name, value <span class="keyword">in</span> bound.arguments.items():</span><br><span class="line"><span class="meta">... </span>    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;name:&lt;<span class="number">6</span>&#125;</span> = <span class="subst">&#123;value&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="meta">... </span></span><br><span class="line">a      = <span class="number">1</span></span><br><span class="line">args   = (<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">kwargs = &#123;<span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bound = sig.bind(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, a=<span class="number">4</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File ...</span><br><span class="line">TypeError: multiple values <span class="keyword">for</span> argument <span class="string">&#x27;a&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="函数参数传递"><a href="#函数参数传递" class="headerlink" title="函数参数传递"></a>函数参数传递</h4><p>说起函数参数传递，可能就有人想起了引用传递、值传递……忘掉这两个概念，来看看下面两个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">foo1</span>(<span class="params">param: <span class="built_in">list</span></span>):</span><br><span class="line">    param += [<span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">arg1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">foo1(arg1)</span><br><span class="line"><span class="built_in">print</span>(arg1)  <span class="comment"># 输出[1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>

<p>内存中有一个<code>list</code>对象（[1, 2, 3]），该对象有两个别名：<code>arg1</code>和<code>param</code>。由于<code>list</code>对象是可变的（mutable），所以可以通过<code>param</code>这个别名修改这个<code>list</code>对象的内容。</p>
<img src="https://www.yooo.ltd/images/2020/07/04/list.webp" width="75%" alt="参数传递示例01" align=center />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">foo2</span>(<span class="params">param: <span class="built_in">tuple</span></span>):</span><br><span class="line">    param += (<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">arg2 = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">foo2(arg2)</span><br><span class="line"><span class="built_in">print</span>(arg2)  <span class="comment"># 输出(1, 2, 3)</span></span><br></pre></td></tr></table></figure>

<p>内存中有一个<code>tuple</code>对象（(1, 2, 3)），该对象也有两个别名：<code>arg2</code>和<code>param</code>。但由于<code>tuple</code>对象是不可变的(immutable)，当执行param +&#x3D; (4, 5)时，解释器创建了一个新的<code>tuple</code>对象（(1, 2, 3, 4, 5)），并让<code>param</code>指向这个新的对象，而原来的对象没有被改变。</p>
<img src="https://www.yooo.ltd/images/2020/07/04/tuple.webp" width="75%" alt="参数传递示例02" align=center />

<p>在Python中，参数传递本质上是为已有的对象取了一个函数作用域级别的别名。如果该对象是可变的，那么就可以在函数内修改该对象，这种修改也可以被其它的别名所感知。弄清楚对象、别名的关系，就不会对值传递、引用传递这种说法感到困惑了。</p>
<h2 id="NumPy初步"><a href="#NumPy初步" class="headerlink" title="NumPy初步"></a>NumPy初步</h2><p>NumPy是Python中科学计算的基本软件包。它是一个Python库，提供多维数组对象，各种派生对象（例如蒙版数组和矩阵）以及各种例程，用于对数组进行快速操作，包括数学，逻辑，形状处理，排序，选择，I&#x2F;O，离散傅立叶变换，基本线性代数，基本统计运算，随机模拟等等。</p>
<h3 id="NumPy安装"><a href="#NumPy安装" class="headerlink" title="NumPy安装"></a>NumPy安装</h3><p>安装NumPy的唯一前提是Python本身。而Python官网上的发行版是不包含NumPy模块的。如果你希望以最简单的方式开始使用，建议你使用Anaconda发行版，它包括Python，NumPy和许多其他用于科学计算和数据科学常用的软件包。同时支持Linux、Windows和mac。</p>
<p>如果你没有NumPy，在windows平台的cmd窗口可以通过如下命令执行安装：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install numpy</span><br></pre></td></tr></table></figure>

<p>默认情况使用国外线路，如果太慢，我们使用清华的镜像就可以:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install numpy -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>

<p>Mac 系统的 Homebrew 不包含 NumPy 或其他一些科学计算包，同样可以采用以下方式进行安装。打开终端，输入：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install numpy -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>

<p>完成安装后，你可以进行验证：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<p>NumPy的历史可以追溯到90年代中期，它的前身为Numeric（用C语言编写，主要用来调取C++中应用）和Numarray（用于处理高维数组，可灵活的索引、数据类型变换、广播等），2005年出现的NumPy作为继承者，吸取了Numeric中丰富的C API及Numarray的高维数组处理能力，成为Python科学计算生态系统的基础。追根溯源，NumPy是集成在Python编程语言中的向量化运算工具集，如果你是用的是Intel的CPU，它将直接调用MKL库执行C语言的向量计算库，这是目前速度最快的向量计算库。</p>
<p>将大规模向量、矩阵运算交给NumPy如果对数组进行向量化运算，例如全体四则运算、矩阵乘法、求和、按指标求和等，一定要利用NumPy的矩阵运算。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">a = np.random.rand(<span class="number">1000000</span>)    <span class="comment"># 创建两个百万维的数组</span></span><br><span class="line">b = np.random.rand(<span class="number">1000000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">begin = time.time()            <span class="comment"># 分别用np.dot和for循环对两个数组进行点乘</span></span><br><span class="line">c = np.dot(a,b)</span><br><span class="line">end = time.time()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;使用np.dot方法(向量化)用的时间:&#123;&#125; ms.&quot;</span>.<span class="built_in">format</span>(<span class="number">1000</span>*(end-begin)))</span><br><span class="line"></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line">begin = time.time()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">1000000</span>):</span><br><span class="line">    c += a[i]*b[i]</span><br><span class="line">end = time.time()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;使用for循环用的时间:&#123;&#125; ms.&quot;</span>.<span class="built_in">format</span>(<span class="number">1000</span>*(end-begin)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">249715.57341423497</span></span><br><span class="line">使用np.dot方法(向量化)用的时间:<span class="number">1.9905567169189453</span> ms.</span><br><span class="line"><span class="number">249715.57341423733</span></span><br><span class="line">使用<span class="keyword">for</span>循环用的时间:<span class="number">1073.1749534606934</span> ms.</span><br></pre></td></tr></table></figure>


<h2 id="Python-代码的性能分析"><a href="#Python-代码的性能分析" class="headerlink" title="Python 代码的性能分析"></a>Python 代码的性能分析</h2><p>我们怎样知道执行某个Python文件、某个函数、某段代码所耗费的总体时间？</p>
<p>作为样例，本文使用slow_func.py来进行性能分析，内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func1</span>():</span><br><span class="line">    time.sleep(<span class="number">1</span>)  <span class="comment"># 等待一秒</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func2</span>():</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> ** <span class="number">24</span>):</span><br><span class="line">        random.random()  <span class="comment"># 生成1600万个随机数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    func1()</span><br><span class="line">    func2()</span><br></pre></td></tr></table></figure>

<p>函数func1和func2的区别在于：CPU在执行func1时基本处在闲置状态，在执行func2()时基本处于忙碌状态。这点会在之后的测试中有所体现。在笔者的测试平台（Ubuntu 18.04+Python 3.6）上，两个函数所耗费的时间均在1s左右。</p>
<h3 id="time命令"><a href="#time命令" class="headerlink" title="time命令"></a>time命令</h3><p>类UNIX平台提供了time命令以统计执行执行命令所花费的时间。当然，这是一个通用型的工具，而不局限于Python。</p>
<p>执行如下shell命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time python3 slow_func.py</span><br></pre></td></tr></table></figure>

<p>获得如下结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">real	0m1.960s  # 命令执行时间</span><br><span class="line">user	0m0.946s  # 用户态CPU时间</span><br><span class="line">sys 	0m0.008s</span><br></pre></td></tr></table></figure>

<p>根据前两行结果中我们可以得知，slow_func.py从开始到结束共消耗了2秒左右的时间，但实际消耗的用户态CPU时间只有1秒左右。这是因为CPU在执行func1()时处于等待状态（sleep），这段时间里是不消耗CPU时间的。</p>
<h3 id="time库"><a href="#time库" class="headerlink" title="time库"></a>time库</h3><p>Python提供了标准库time来进行关于时间的操作，我们可以通过这个库来测量代码执行所耗费的时间。</p>
<p>执行如下Python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> slow_func <span class="keyword">import</span> func1, func2</span><br><span class="line"></span><br><span class="line">start1, start2 = time.perf_counter(), time.process_time()</span><br><span class="line">func1()</span><br><span class="line">func2()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;perf_counter: &#123;:.4f&#125;s&#x27;</span>.<span class="built_in">format</span>(time.perf_counter() - start1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;process_time: &#123;:.4f&#125;s&#x27;</span>.<span class="built_in">format</span>(time.process_time() - start2))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;获得如下结果：&quot;&quot;&quot;</span></span><br><span class="line">perf_counter: <span class="number">2.1201</span>s</span><br><span class="line">process_time: <span class="number">1.1119</span>s</span><br></pre></td></tr></table></figure>

<p>time.perf_counter()的时间差是代码开始与代码结束两个时间点的时间差，而time.process_time()的时间差是消耗的CPU时间长度，所以得出了不同的结果，这与先前的time命令的原因和结果相类似。</p>
<h3 id="time库-上下文管理器"><a href="#time库-上下文管理器" class="headerlink" title="time库+上下文管理器"></a>time库+上下文管理器</h3><p>上面提到的用time库来测量代码耗时用起来很方便，但如果经常要用到的话写起来也很繁琐。这时我们可以写一个自定义的上下文管理器来避免重复代码。</p>
<p>执行如下Python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> contextmanager</span><br><span class="line"></span><br><span class="line"><span class="meta">@contextmanager</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">time_block</span>(<span class="params">label</span>):  <span class="comment"># 代码块计时上下文管理器</span></span><br><span class="line">    <span class="comment"># 进入上下文</span></span><br><span class="line">    start = time.perf_counter()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">yield</span>  <span class="comment"># 执行代码块</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="comment"># 执行完成后输出代码块耗时</span></span><br><span class="line">        used = time.perf_counter() - start</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125;: &#123;:.4f&#125;s&#x27;</span>.<span class="built_in">format</span>(label, used))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用法</span></span><br><span class="line"><span class="keyword">with</span> time_block(<span class="string">&#x27;sleep&#x27;</span>):</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">获得如下结果：</span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line">sleep: <span class="number">1.0011</span>s</span><br></pre></td></tr></table></figure>

<h3 id="time库-函数装饰器"><a href="#time库-函数装饰器" class="headerlink" title="time库+函数装饰器"></a>time库+函数装饰器</h3><p>上下文管理器针对的是代码块，如果只想统计函数执行所消耗的时间，用函数装饰器更为方便和快捷。</p>
<p>执行如下Python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">time_wrap</span>(<span class="params">func</span>):  <span class="comment"># 函数计时装饰器</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        start = time.perf_counter()</span><br><span class="line">        r = func(*args, **kwargs)</span><br><span class="line">        used = time.perf_counter() - start</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#123;f.__module__&#125;.&#123;f.__name__&#125;: &#123;t:.4f&#125;s&#x27;</span>.<span class="built_in">format</span>(f=func, t=used))</span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@time_wrap  </span><span class="comment"># 函数定义时使用装饰器</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">slow_func</span>():</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行函数时自动调用装饰器</span></span><br><span class="line">slow_func()</span><br><span class="line">获得如下结果：</span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line">__main__.slow_func: <span class="number">1.0008</span>s</span><br></pre></td></tr></table></figure>

<h3 id="timeit库"><a href="#timeit库" class="headerlink" title="timeit库"></a>timeit库</h3><p>当需要多次重复测量Python代时以获取精确的耗时结果时，我们可以通过循环控制配合上文提到的方法来实现，也可以通过一个更便捷的、适合重复测试的标准库：timeit来实现。</p>
<p>执行如下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line"></span><br><span class="line">setup = <span class="string">&#x27;from slow_func import func1&#x27;</span></span><br><span class="line"></span><br><span class="line">used = timeit.timeit(<span class="string">&#x27;func1()&#x27;</span>, setup=setup, number=<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#123;:.4f&#125;&#x27;</span>.<span class="built_in">format</span>(used))</span><br><span class="line">获得如下结果：</span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">5.0039</span></span><br></pre></td></tr></table></figure>

<p>timeit库默认使用的计时器为time.perf_counter()，如果想换成测量CPU耗时的计时器，只需要附加上timer参数即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">timer = time.process_time</span><br><span class="line"></span><br><span class="line">used = timeit.timeit(<span class="string">&#x27;func1()&#x27;</span>, timer=timer, setup=setup, number=<span class="number">5</span>)  <span class="comment"># 附加timer参数</span></span><br></pre></td></tr></table></figure>

<h3 id="cProfile"><a href="#cProfile" class="headerlink" title="cProfile"></a>cProfile</h3><p>而在实际的性能分析场景中，目标代码的逻辑往往比较复杂，光靠总体执行耗时并不能帮助我们快速定位性能瓶颈。这个时候就需要请出Python的标准库：cProfile（官方文档）来对代码进行细致的性能分析了。</p>
<h4 id="命令行使用cProfile"><a href="#命令行使用cProfile" class="headerlink" title="命令行使用cProfile"></a>命令行使用cProfile</h4><p>对于单独的Python代码文件来说，通过命令行使用cProfile无疑是最方便的选择。</p>
<p>执行如下shell命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m cProfile -s tottime slow_func.py</span><br></pre></td></tr></table></figure>

<p>首先用python3的-m选项调用cProfile模块，然后用cProfile的-s选项让输出结果按tottime进行排序，最后执行slow_func.py文件。</p>
<p>完整调用格式为：<code>python -m cProfile [-o output_file] [-s sort_order] myscript.py</code></p>
<p>得到如下结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">        16778563 function calls (16778520 primitive calls) in 3.176 seconds</span><br><span class="line"></span><br><span class="line">  Ordered by: internal time</span><br><span class="line"></span><br><span class="line">  ncalls  tottime  percall  cumtime  percall filename:lineno(function)</span><br><span class="line">       1    1.456    1.456    2.172    2.172 slow_func.py:8(func2)</span><br><span class="line">       1    1.001    1.001    1.001    1.001 &#123;built-in method time.sleep&#125;</span><br><span class="line">16777216    0.716    0.000    0.716    0.000 &#123;method &#x27;random&#x27; of &#x27;_random.Random&#x27; objects&#125;</span><br><span class="line">       1    0.001    0.001    0.001    0.001 &#123;built-in method _imp.create_dynamic&#125;</span><br><span class="line">       3    0.000    0.000    0.000    0.000 &#123;built-in method marshal.loads&#125;</span><br><span class="line">       # ...省略后续100多行</span><br></pre></td></tr></table></figure>

<ul>
<li>输出的第1行表明，脚本文件执行中存在1600多万次的函数调用，共耗费3.268秒。<br>** 而根据前一篇文章的测试结果，直接执行该脚本文件只需要2秒左右的时间，那多出来的1秒多花在了哪里？这是因为cProfile需要对每一次函数调用进行监控和记录，由于该文件存在较多的函数调用，所以总执行耗时也就增长了许多了。</li>
<li>第3行表明，下表内容按照internal time（内部执行时间，tottime）排序，这是由执行命令中的-s tottime参数决定的。</li>
<li>第5行为分析结果表的表头，依次为ncalls：调用次数、tottime：内部执行耗时、percall：内部执行耗时&#x2F;调用次数、cumtime：累计执行耗时、percall：累计执行耗时&#x2F;调用次数，以及最后的文件名+行号+函数名称。<br>** tottime和cumtime的区别在于，tottime不包括子函数执行所花费的时间，而cumtime是包括的。</li>
<li>第6行表明，slow_func.py中第8行的func2函数共执行了1次，内部耗时1.456秒，累计耗时2.172秒。</li>
<li>第7行表明，Python内置的sleep函数共执行了一次，耗时1.001秒。</li>
<li>第8行表明，Python内置的random函数共执行了1600多万次，耗时0.716秒。<br>** 由于random函数是被func2函数调用的，所以这0.716秒和func2函数的内部执行耗时1.456秒，共同组成了func2函数的累计执行耗时：2.172秒。</li>
<li>由于是用cProfile分析整个脚本文件，所以许多Python自身所需的函数调用也被展示在了结果里，所以分析结果表才会有100多行的规模。这个问题可以在下一小节中解决。</li>
</ul>
<h3 id="代码里使用cProfile"><a href="#代码里使用cProfile" class="headerlink" title="代码里使用cProfile"></a>代码里使用cProfile</h3><p>从本质上来说，通过命令行使用cProfile相当于在代码里使用cProfile的一个简化操作。而在命令行里分析代码有着明显的局限性：目标代码必须独立成文件、输出格式固定等等。所以，在代码里使用cProfile往往是一个更优的选择。<br>执行如下Python代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cProfile</span><br><span class="line"><span class="keyword">import</span> pstats</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> StringIO</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> slow_func <span class="keyword">import</span> func1, func2</span><br><span class="line"></span><br><span class="line">profile = cProfile.Profile()</span><br><span class="line">profile.enable()  <span class="comment"># 分析开始</span></span><br><span class="line">func1()</span><br><span class="line">func2()</span><br><span class="line">profile.disable()  <span class="comment"># 分析结束</span></span><br><span class="line">ram_file = StringIO()</span><br><span class="line">sort_by = <span class="string">&#x27;tottime&#x27;</span></span><br><span class="line">stats = pstats.Stats(profile, stream=ram_file)  <span class="comment"># 读取结果</span></span><br><span class="line">stats.strip_dirs().sort_stats(sort_by).print_stats()  <span class="comment"># 按格式输出至ram_file</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ram_file.getvalue())</span><br></pre></td></tr></table></figure>

<p>代码的核心逻辑是使用cProfile模块的Profile类对代码块进行性能分析，分析完成后使用pstats模块的Stats类将分析结果按一定格式写入至内存文件，最后输出该文件里写入的内容。</p>
<p>实际上这只是一个较为简单的样例，pstats模块还可以获得函数之间的调用关系、将结果持久化、显示文件路径等等，更完整的说明可以参考官方文档。</p>
<p>得到如下结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">        16777220 function calls in 3.225 seconds</span><br><span class="line"></span><br><span class="line">  Ordered by: internal time</span><br><span class="line"></span><br><span class="line">  ncalls  tottime  percall  cumtime  percall filename:lineno(function)</span><br><span class="line">       1    1.517    1.517    2.224    2.224 slow_func.py:8(func2)</span><br><span class="line">       1    1.001    1.001    1.001    1.001 &#123;built-in method time.sleep&#125;</span><br><span class="line">16777216    0.707    0.000    0.707    0.000 &#123;method &#x27;random&#x27; of &#x27;_random.Random&#x27; objects&#125;</span><br><span class="line">       1    0.000    0.000    1.001    1.001 slow_func.py:5(func1)</span><br><span class="line">       1    0.000    0.000    0.000    0.000 &#123;method &#x27;disable&#x27; of &#x27;_lsprof.Profiler&#x27; objects&#125;</span><br></pre></td></tr></table></figure>

<h3 id="cProfile结果可视化"><a href="#cProfile结果可视化" class="headerlink" title="cProfile结果可视化"></a>cProfile结果可视化</h3><p>一般来说，通过以上两个例子就可以获得完善的性能分析报告了。但通过一些可视化工具对<code>cProfile</code>的报告进行二次处理，我们可以更清晰地观察函数之间的调用关系、更轻松地找出性能瓶颈，算是一个不错的辅助手段。在这里只介绍一种可视化工具：JetBrain PyCharm自带的Profile工具。</p>
<p>点击Pycharm中Run菜单里的Profile ‘xxx’项目，即可对当前运行执行方案使用cProfile进行性能分析，如下图：</p>
<img src="https://www.yooo.ltd/images/2019-03-08.01.png" width="45%" align=center />

<p>结果如下图所示。其中，Time对应cProfile中的cumtime，即累计执行耗时；Own Time对应cProfile中的tottime，即内部执行耗时。</p>
<img src="https://www.yooo.ltd/images/2019-03-08.02.png" width="95%" align=center />

<p>&emsp;</p>
<img src="https://www.yooo.ltd/images/2019-03-08.03.png" width="95%" align=center />
    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Hai-Wei Chai (柴海伟)
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://hwchai.com/PythonLes03/" title="Python在科研中的应用 02：函数、流程控制语句与NumPy初步">https://hwchai.com/PythonLes03/</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"># Python</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/Exp002-ArticleReply/" rel="prev" title="期刊投稿的准备工作及注意事项">
                  <i class="fa fa-angle-left"></i> 期刊投稿的准备工作及注意事项
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/PythonLes04/" rel="next" title="Python在科研中的应用 03：科学计算环境 NumPy">
                  Python在科研中的应用 03：科学计算环境 NumPy <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-user"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Hai-Wei Chai (柴海伟)</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"https://vercel.hwchai.com/","cssUrl":"https://hwchai.com/download/Waline.css","commentCount":true,"pageview":false,"locale":{"placeholder":"请留下邮箱，若有回复您将收到提醒。QQ邮箱可以自动识别头像喔~"},"pageSize":10,"visitor":false,"comment_count":true,"meta":["nick","mail","link"],"requiredMeta":["nick"],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","emoji":["https://unpkg.com/@waline/emojis@1.0.1/bilibili"],"login":"disable","el":"#waline","comment":true,"path":"/PythonLes03/"}</script>
<link rel="stylesheet" href="https://hwchai.com/download/Waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

</body>
</html>
